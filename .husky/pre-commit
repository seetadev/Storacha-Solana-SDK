#!/usr/bin/env sh

# Check if UI package.json has workspace:* for SOL package
if grep -q '"@toju.network/sol": "workspace:\*"' ui/package.json; then
  echo "Found workspace:* - updating SOL sdk dependency in ui/ to latest version..."
  cd ui && pnpm add @toju.network/sol@latest
  
  # Stage the updated package.json and lockfile
  git add package.json ../pnpm-lock.yaml
  
  echo "@toju.network/sol updated to latest version"
else
  echo "@toju.network/sol already using published version, skipping update"
fi

# Check if UI package.json has workspace:* for FIL package

if grep -q '"@toju.network/fil": "workspace:\*"' ui/package.json; then
echo "Found workspace:* for FIL - building FIL package..."
cd packages/fil && pnpm build

echo "@toju.network/fil built successfully"
else
echo "@toju.network/fil not using workspace protocol, skipping build"
fi
